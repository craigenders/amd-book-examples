imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
# plot ranges
xrange <- c(20,80)
yrange <- c(20,80)
# load jomo data
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- impdata[impdata$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- impdata[impdata$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# data to plot
imp1 <- impdata[impdata$Imputation == 1, c("mathpre", "mathpost")]
obs1 <- impdata[impdata$Imputation == 1 & missind == F, c("mathpre", "mathpost")]
mis1 <- impdata[impdata$Imputation == 1 & missind == T, c("mathpre", "mathpost")]
imp2 <- impdata[impdata$Imputation == 2, c("mathpre", "mathpost")]
obs2 <- impdata[impdata$Imputation == 2 & missind == F, c("mathpre", "mathpost")]
mis2 <- impdata[impdata$Imputation == 2 & missind == T, c("mathpre", "mathpost")]
imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
# plot
pdf(paste0(outputs, "Figure ", chapter, ".", figure, ".pdf"))
par(font.main = 3, cex.main = cexvalue0, cex.axis = cexvalue0, cex.lab = cexvalue0, mar = margins)
layout(matrix(c(1,2,3,4,5,6), 3, 2, byrow = TRUE))
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis1, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp1$mathpost ~ imp1$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs2, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis2, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp2$mathpost ~ imp2$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs3, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis3, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp3$mathpost ~ imp3$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs4, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis4, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp4$mathpost ~ imp4$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs5, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis5, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp5$mathpost ~ imp5$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs6, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis6, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp6$mathpost ~ imp6$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
mtext(expression(italic("Figure 7.6: Six FCS Data Sets")), side=3, outer=TRUE, line=-1.5)
dev.off()
# plot
pdf(paste0(outputs, "Figure ", chapter, ".", figure, ".pdf"))
par(font.main = 3, cex.main = cexvalue0, cex.axis = cexvalue0, cex.lab = cexvalue0, mar = margins)
layout(matrix(c(1,2,3,4,5,6), 3, 2, byrow = TRUE))
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis1, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp1$mathpost ~ imp1$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs2, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis2, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp2$mathpost ~ imp2$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs3, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis3, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp3$mathpost ~ imp3$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs4, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis4, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp4$mathpost ~ imp4$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs5, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis5, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp5$mathpost ~ imp5$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs6, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis6, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp6$mathpost ~ imp6$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
mtext(expression(italic("Figure 7.7: Six FCS Data Sets")), side=3, outer=TRUE, line=-1.5)
dev.off()
# labels
figure <- 7
text <- "Six Fully Conditional Specification Data Sets"
if(figuretitles == 2){title <- paste0("Figure ", chapter, ".", figure, ": ", text)} else if(figuretitles == 1)
{title <- paste0("Figure ", chapter, ".", figure)} else {title <- ""}
Xlab <- "Math Pre-Test"
Ylab <- "Math Post-Test"
# plot ranges
xrange <- c(20,80)
yrange <- c(20,80)
# load jomo data
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- impdata[impdata$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# data to plot
imp1 <- impdata[impdata$Imputation == 1, c("mathpre", "mathpost")]
obs1 <- impdata[impdata$Imputation == 1 & missind == F, c("mathpre", "mathpost")]
mis1 <- impdata[impdata$Imputation == 1 & missind == T, c("mathpre", "mathpost")]
imp2 <- impdata[impdata$Imputation == 2, c("mathpre", "mathpost")]
obs2 <- impdata[impdata$Imputation == 2 & missind == F, c("mathpre", "mathpost")]
mis2 <- impdata[impdata$Imputation == 2 & missind == T, c("mathpre", "mathpost")]
imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
# plot
pdf(paste0(outputs, "Figure ", chapter, ".", figure, ".pdf"))
par(font.main = 3, cex.main = cexvalue0, cex.axis = cexvalue0, cex.lab = cexvalue0, mar = margins)
layout(matrix(c(1,2,3,4,5,6), 3, 2, byrow = TRUE))
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis1, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp1$mathpost ~ imp1$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs2, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis2, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp2$mathpost ~ imp2$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs3, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis3, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp3$mathpost ~ imp3$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs4, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis4, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp4$mathpost ~ imp4$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs5, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis5, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp5$mathpost ~ imp5$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs6, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis6, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp6$mathpost ~ imp6$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
mtext(expression(italic("Figure 7.7: Six FCS Data Sets")), side=3, outer=TRUE, line=-1.5)
dev.off()
imp1
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
obs
obs1
# load jomo data
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- impdata[impdata$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# data to plot
imp1 <- impdata[impdata$Imputation == 1, c("mathpre", "mathpost")]
obs1 <- impdata[impdata$Imputation == 1 & missind == F, c("mathpre", "mathpost")]
mis1 <- impdata[impdata$Imputation == 1 & missind == T, c("mathpre", "mathpost")]
imp2 <- impdata[impdata$Imputation == 2, c("mathpre", "mathpost")]
obs2 <- impdata[impdata$Imputation == 2 & missind == F, c("mathpre", "mathpost")]
mis2 <- impdata[impdata$Imputation == 2 & missind == T, c("mathpre", "mathpost")]
imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
obs1
missind
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- impdata[imps$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# data to plot
imp1 <- impdata[impdata$Imputation == 1, c("mathpre", "mathpost")]
obs1 <- impdata[impdata$Imputation == 1 & missind == F, c("mathpre", "mathpost")]
mis1 <- impdata[impdata$Imputation == 1 & missind == T, c("mathpre", "mathpost")]
imp2 <- impdata[impdata$Imputation == 2, c("mathpre", "mathpost")]
obs2 <- impdata[impdata$Imputation == 2 & missind == F, c("mathpre", "mathpost")]
mis2 <- impdata[impdata$Imputation == 2 & missind == T, c("mathpre", "mathpost")]
imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
# plot
pdf(paste0(outputs, "Figure ", chapter, ".", figure, ".pdf"))
par(font.main = 3, cex.main = cexvalue0, cex.axis = cexvalue0, cex.lab = cexvalue0, mar = margins)
layout(matrix(c(1,2,3,4,5,6), 3, 2, byrow = TRUE))
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis1, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp1$mathpost ~ imp1$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs2, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis2, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp2$mathpost ~ imp2$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs3, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis3, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp3$mathpost ~ imp3$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs4, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis4, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp4$mathpost ~ imp4$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs5, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis5, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp5$mathpost ~ imp5$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs6, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6a, pch = 21, cex = cexvalue_1)
points(mis6, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp6$mathpost ~ imp6$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
mtext(expression(italic("Figure 7.7: Six FCS Data Sets")), side=3, outer=TRUE, line=-1.5)
dev.off()
obs1
mis1
missind
imp0
load(file = "~/dropbox/working/applied missing data v2/examples/mi/7.4 - jm/imps.r")
imp0 <- imps[imps$Imputation == 0, ]
missind <- is.na(imp0$mathpost)
missind
# read blimp data
impdata <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# data to plot
imp1 <- impdata[impdata$Imputation == 1, c("mathpre", "mathpost")]
obs1 <- impdata[impdata$Imputation == 1 & missind == F, c("mathpre", "mathpost")]
mis1 <- impdata[impdata$Imputation == 1 & missind == T, c("mathpre", "mathpost")]
imp2 <- impdata[impdata$Imputation == 2, c("mathpre", "mathpost")]
obs2 <- impdata[impdata$Imputation == 2 & missind == F, c("mathpre", "mathpost")]
mis2 <- impdata[impdata$Imputation == 2 & missind == T, c("mathpre", "mathpost")]
imp3 <- impdata[impdata$Imputation == 3, c("mathpre", "mathpost")]
obs3 <- impdata[impdata$Imputation == 3 & missind == F, c("mathpre", "mathpost")]
mis3 <- impdata[impdata$Imputation == 3 & missind == T, c("mathpre", "mathpost")]
imp4 <- impdata[impdata$Imputation == 4, c("mathpre", "mathpost")]
obs4 <- impdata[impdata$Imputation == 4 & missind == F, c("mathpre", "mathpost")]
mis4 <- impdata[impdata$Imputation == 4 & missind == T, c("mathpre", "mathpost")]
imp5 <- impdata[impdata$Imputation == 5, c("mathpre", "mathpost")]
obs5 <- impdata[impdata$Imputation == 5 & missind == F, c("mathpre", "mathpost")]
mis5 <- impdata[impdata$Imputation == 5 & missind == T, c("mathpre", "mathpost")]
imp6 <- impdata[impdata$Imputation == 6, c("mathpre", "mathpost")]
obs6 <- impdata[impdata$Imputation == 6 & missind == F, c("mathpre", "mathpost")]
mis6 <- impdata[impdata$Imputation == 6 & missind == T, c("mathpre", "mathpost")]
# plot
pdf(paste0(outputs, "Figure ", chapter, ".", figure, ".pdf"))
par(font.main = 3, cex.main = cexvalue0, cex.axis = cexvalue0, cex.lab = cexvalue0, mar = margins)
layout(matrix(c(1,2,3,4,5,6), 3, 2, byrow = TRUE))
plot(obs1, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis1, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp1$mathpost ~ imp1$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs2, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis2, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp2$mathpost ~ imp2$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs3, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis3, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp3$mathpost ~ imp3$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs4, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis4, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp4$mathpost ~ imp4$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs5, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis5, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp5$mathpost ~ imp5$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
plot(obs6, xlim = range(xrange), ylim = range(yrange), xlab = NA, ylab = NA, axes = F, frame.plot = F, col = color6b, pch = 21, cex = cexvalue_1)
points(mis6, col = color0, pch = 3, cex = cexvalue_1)
abline(lm(imp6$mathpost ~ imp6$mathpre), lty = linetype1, lwd = linesize1)
axis(side = 1)
axis(side = 2)
title(xlab = Xlab, ylab = Ylab, mgp = axislabelspacing)
mtext(expression(italic("Figure 7.7: Six FCS Data Sets")), side=3, outer=TRUE, line=-1.5)
dev.off()
# load packages
library("jomo")
library("mitml")
# set random number seed for imputation
set.seed(90291)
# set working directory to the location of this script
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
# read data from working directory
dat <- read.table(paste0(getwd(), "/math.dat"))
names(dat) <- c("id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# recode missing values
dat[dat == 999] <- NA
# define binary variable as factor
dat$lunchasst <- factor(data$lunchasst, levels = c(0,1))
# select variables
vars <- c("lunchasst", "stanread","mathpre", "mathpost")
# joint model imputation with jomo
imps <- jomo(dat[vars], nburn = 1000, nbetween = 1000, nimp = 100)
# compute change score and save data
imps$change <- imps$mathpost - imps$mathpre
save(imps, file = paste0(getwd(), "/imps.R"))
# load(file = paste0(getwd(), "/imps.R"))
# analysis and pooling
implist <- as.mitml.list(split(impdata, impdata$Imputation))
analysis <- with(implist, lm(change ~ 1))
estimates <- testEstimates(analysis, var.comp = T, df.com = 249)
estimates
confint(estimates, level = .95)
estimates <- testEstimates(analysis, var.comp = T, df.com = NULL)
estimates
confint(estimates, level = .95)
resultsbyimp <- matrix(0, nrow = 100, ncol = 2)
for(m in 1:100){
impdat <- impdata[impdata$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(change)
resultsbyimp[m,2] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
descbyimp <- matrix(0, nrow = 100, ncol = 4)
for(m in 1:100){
impdat <- impdata[impdata$Imputation == m, c("mathpre", "mathpost")]
descbyimp[m,1] <- mean(impdat$mathpre)
descbyimp[m,2] <- sd(impdat$mathpre)
descbyimp[m,3] <- mean(impdat$mathpost)
descbyimp[m,4] <- sd(impdat$mathpost)
}
write.table(descbyimp, file = "~/desktop/jmdesc.dat", col.names = F, row.names = T)
# analysis and pooling
implist <- as.mitml.list(split(imps, imps$Imputation))
analysis <- with(implist, lm(change ~ 1))
estimates <- testEstimates(analysis, var.comp = T, df.com = 249)
estimates
confint(estimates, level = .95)
resultsbyimp <- matrix(0, nrow = 100, ncol = 2)
for(m in 1:100){
impdat <- impdata[impdata$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(change)
resultsbyimp[m,2] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
resultsbyimp <- matrix(0, nrow = 100, ncol = 2)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- imps$mathpost - impimpsdat$mathpre
resultsbyimp[m,1] <- mean(change)
resultsbyimp[m,2] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
m <- 1
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
impdat
resultsbyimp <- matrix(0, nrow = 100, ncol = 2)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- imps$mathpost - imps$mathpre
resultsbyimp[m,1] <- mean(change)
resultsbyimp[m,2] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
resultsbyimp <- matrix(0, nrow = 100, ncol = 2)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(change)
resultsbyimp[m,2] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
resultsbyimp <- matrix(0, nrow = 100, ncol = 6)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(impdat$mathpre)
resultsbyimp[m,2] <- sd(impdat$mathpre)
resultsbyimp[m,3] <- mean(impdat$mathpost)
resultsbyimp[m,4] <- sd(impdat$mathpost)
resultsbyimp[m,5] <- mean(change)
resultsbyimp[m,6] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
load(file = paste0(getwd(), "/imps.R"))
resultsbyimp <- matrix(0, nrow = 100, ncol = 6)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(impdat$mathpre)
resultsbyimp[m,2] <- sd(impdat$mathpre)
resultsbyimp[m,3] <- mean(impdat$mathpost)
resultsbyimp[m,4] <- sd(impdat$mathpost)
resultsbyimp[m,5] <- mean(change)
resultsbyimp[m,6] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/jmest.dat", col.names = F, row.names = T)
imps <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(impdata) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
imps <- read.table(file = "~/dropbox/working/applied missing data v2/examples/mi/7.5 - fcs/imps.dat")
names(imps) <- c("Imputation", "id", "male", "lunchasst", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
resultsbyimp <- matrix(0, nrow = 100, ncol = 6)
for(m in 1:100){
impdat <- imps[imps$Imputation == m, c("mathpre", "mathpost")]
change <- impdat$mathpost - impdat$mathpre
resultsbyimp[m,1] <- mean(impdat$mathpre)
resultsbyimp[m,2] <- sd(impdat$mathpre)
resultsbyimp[m,3] <- mean(impdat$mathpost)
resultsbyimp[m,4] <- sd(impdat$mathpost)
resultsbyimp[m,5] <- mean(change)
resultsbyimp[m,6] <- sd(change) / sqrt(length(change))
}
write.table(resultsbyimp, file = "~/desktop/fcsest.dat", col.names = F, row.names = T)
