fit <- mdmb::frm_em(dat = dat, dep = model.disability, ind = predictor.models)
summary(fit)
# model for disability outcome (disability | depress male depress*male pain)
model.disability <- list("model" = "linreg", "formula" = disability ~ I(depress - 14.718) + male + I((depress - 14.718)*male) + pain, nodes = nodes.disability)
# example 3.8: moderated regression with factored specification for incomplete predictors
# requires fdir, lavaan, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("pain.dat", na.strings = "999")
names(dat) <- c("id", "txgrp", "male", "age", "edugroup", "workhrs", "exercise", "paingrps",
"pain", "anxiety", "stress", "control", "depress", "interfere", "disability",
paste0("dep", seq(1:7)), paste0("int", seq(1:6)), paste0("dis", seq(1:6)))
# specify lavaan model for sample statistics
model <- '
disability ~~ depress
disability ~~ male
disability ~~ pain
depress ~~ male
depress ~~ pain
male ~~ pain
'
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(model, dat, meanstructure = TRUE, missing = "fiml")
# summarize incomplete predictors to determine ranges for pseudo-imputations
summary(dat[,c("disability","depress","male","pain")])
# set ranges (nodes) for pseudo-imputations
nodes.pain <- c(0,1)
nodes.depress <- seq(0, 35, by = 1)
nodes.disability <- seq(0, 47, by = 1)
# model for pain predictor (pain | male)
model.pain <- list( "model"="logistic", "formula" = pain ~ male, nodes = nodes.pain)
# model for depression predictor (depress | pain male)
model.depress <- list( "model"="linreg", "formula" = depress ~ pain + male, nodes = nodes.depress)
# model for disability outcome (disability | depress male depress*male pain)
# depression mean = 14.718
model.disability <- list("model" = "linreg", "formula" = disability ~ I(depress - 14.718) + male + I((depress - 14.718)*male) + pain, nodes = nodes.disability)
# combine predictor models into a list
predictor.models <- list(pain = model.pain, depress = model.depress)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.disability, ind = predictor.models)
summary(fit)
# example 3.8: moderated regression with factored specification for incomplete predictors
# requires fdir, lavaan, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("math.dat", na.strings = "999")
names(dat) <- c("id", "male", "frlunch", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# specify lavaan model for sample statistics
model <- '
mathpost ~~ anxiety
mathpost ~~ frlunch
mathpost ~~ mathpre
mathpost ~~ male
anxiety ~~ frlunch
anxiety ~~ mathpre
anxiety ~~ male
frlunch ~~ mathpre
frlunch ~~ male
mathpre ~~ male
'
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(model, dat, meanstructure = TRUE, missing = "fiml")
# summarize incomplete predictors to determine ranges for pseudo-imputations
summary(dat[,c("mathpost","anxiety","frlunch","mathpre","male")])
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(model, dat, meanstructure = TRUE, missing = "fiml")
# combine predictor models into a list
predictor.models <- list(frlunch = model.frlunch, anxiety = model.anxiety)
# example 3.8: moderated regression with factored specification for incomplete predictors
# requires fdir, lavaan, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("math.dat", na.strings = "999")
names(dat) <- c("id", "male", "frlunch", "achievegrp", "stanread", "efficacy", "anxiety", "mathpre", "mathpost")
# specify lavaan model for sample statistics
model <- '
mathpost ~~ anxiety
mathpost ~~ frlunch
mathpost ~~ mathpre
mathpost ~~ male
anxiety ~~ frlunch
anxiety ~~ mathpre
anxiety ~~ male
frlunch ~~ mathpre
frlunch ~~ male
mathpre ~~ male
'
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(model, dat, meanstructure = TRUE, missing = "fiml")
# summarize incomplete predictors to determine ranges for pseudo-imputations
summary(dat[,c("mathpost","anxiety","frlunch","mathpre","male")])
# set ranges (nodes) for pseudo-imputations
nodes.frlunch <- c(0,1)
nodes.anxiety <- seq(-10, 65, by = 1)
nodes.mathpost <- seq(25, 95, by = 1)
# model for frlunch predictor (frlunch | mathpre male)
model.frlunch <- list("model"="logistic", "formula" = frlunch ~ mathpre + male, nodes.frlunch)
# model for anxiety predictor (anxiety | frlunch mathpre male)
model.anxiety <- list( "model"="linreg", "formula" = anxiety ~ frlunch + mathpre + male, nodes = nodes.anxiety)
# model for mathpost outcome (mathpost | anxiety anxiety^2 frlunch mathpre male
# anxiety mean = 18.058
model.mathpost <- list("model" = "linreg", "formula" = mathpost ~ I(anxiety - 18.058) + I((anxiety - 18.058)^2) + frlunch + mathpre + male, nodes = nodes.mathpost)
# combine predictor models into a list
predictor.models <- list(frlunch = model.frlunch, anxiety = model.anxiety)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.mathpost, ind = predictor.models)
summary(fit)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severe0","severe1","severe3","severe6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model in lavaan
fit <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit, standardize = TRUE)
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model in lavaan
fit <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit, standardize = TRUE)
# estimate saturated correlates model with semtools and lavaan
fit <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
summary(fit, standardize = TRUE)
# specify lavaan model with auxiliary variables as extra outcomes
model.extra.dv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 with severity3'
# estimate extra dependent variable model in
fit <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit, standardize = TRUE)
# specify lavaan model with auxiliary variables as extra outcomes
model.extra.dv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 with severity3'
# estimate extra dependent variable model in
fit <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit, standardize = TRUE)
model.extra.dv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 ~~ severity3'
# estimate extra dependent variable model in
fit <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit, standardize = TRUE)
# specify lavaan model with factored (sequential) specification for auxiliary variables
model.factorav <- 'severity6 ~ drug + severity0 + male
severity3 ~ severity6 + drug + severity0 + male
severity1 ~ severity3 + severity6 + drug + severity0 + male'
# estimate factored regression model for auxiliary variables in lavaan
fit.factorav <- lavaan::sem(model.factorav, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit.factorav, standardize = TRUE)
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(model.extradv, dat, meanstructure = TRUE, missing = "fiml")
# specify lavaan model with auxiliary variables as extra outcomes
model.extradv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 ~~ severity3'
fit.extradv <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
summary(fit.extradv, standardize = TRUE)
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, missing = "fiml")
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
# summarize incomplete variables to determine ranges for pseudo-imputations
summary(dat[,c("severity6","severity3","severity1")])
# set ranges (nodes) for pseudo-imputations
nodes.severity6 <- seq(1, 7, by = .25)
nodes.severity3 <- seq(1, 7, by = .25)
nodes.severity1 <- seq(1, 7, by = .25)
# summarize incomplete variables to determine ranges for pseudo-imputations
summary(dat[,c("severity6","severity0","severity3","severity1")])
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
# set ranges (nodes) for pseudo-imputations
nodes.severity0 <- seq(1, 7, by = .25)
nodes.severity6 <- seq(1, 7, by = .25)
nodes.severity3 <- seq(1, 7, by = .25)
nodes.severity1 <- seq(1, 7, by = .25)
# model for severity0 predictor (severity1 | drug male)
model.severity0 <- list( "model"="linreg", "formula" = severity0 ~ drug + male, nodes = nodes.severity0)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity3 auxiliary variable (severity3 | severity6 severity0 drug male)
model.severity3 <- list( "model"="linreg", "formula" = severity3 ~ severity6 + drug + severity0 + male, nodes = nodes.severity3)
# model for severity1 auxiliary variable (severity1 | severity3 severity6 severity0 drug male)
model.severity1 <- list( "model"="linreg", "formula" = severity1 ~ severity3 + severity6 + drug + severity0 + male, nodes = nodes.severity1)
# combine predictor models into a list (focal model functions as a predictor model)
predictor.models <- list(severity0 = model.severity0, severity6 = model.severity6, severity3 = model.severity3)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug + I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity3 auxiliary variable (severity3 | severity6 severity0 drug male)
model.severity3 <- list( "model"="linreg", "formula" = severity3 ~ severity6 + drug + severity0 + male, nodes = nodes.severity3)
# model for severity1 auxiliary variable (severity1 | severity3 severity6 severity0 drug male)
model.severity1 <- list( "model"="linreg", "formula" = severity1 ~ severity3 + severity6 + drug + severity0 + male, nodes = nodes.severity1)
# combine predictor models into a list (focal model functions as a predictor model)
predictor.models <- list(severity0 = model.severity0, severity6 = model.severity6, severity3 = model.severity3)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.severity1, ind = predictor.models)
summary(fit)
summary(fit.factorav, standardize = TRUE)
# estimate sample statistics in lavaan
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
# model for severity0 predictor (severity1 | drug male)
model.severity0 <- list( "model"="linreg", "formula" = severity0 ~ drug + male, nodes = nodes.severity0)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug + severity0 + male, nodes = nodes.severity6)
# model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug + I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity3 auxiliary variable (severity3 | severity6 severity0 drug male)
model.severity3 <- list( "model"="linreg", "formula" = severity3 ~ severity6 + drug + severity0 + male, nodes = nodes.severity3)
# model for severity1 auxiliary variable (severity1 | severity3 severity6 severity0 drug male)
model.severity1 <- list( "model"="linreg", "formula" = severity1 ~ severity3 + severity6 + drug + severity0 + male, nodes = nodes.severity1)
# combine predictor models into a list (focal model functions as a predictor model)
predictor.models <- list(severity0 = model.severity0, severity6 = model.severity6, severity3 = model.severity3)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.severity1, ind = predictor.models)
summary(fit)
# summarize incomplete variables to determine ranges for pseudo-imputations
summary(dat[,c("severity6","severity0","severity3","severity1")])
summary(fit)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, semtools, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model with no auxiliary variables
fit.noav <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.noav, standardize = TRUE)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, semtools, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model with no auxiliary variables
fit.noav <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.noav, standardize = TRUE)
##################################################################
# saturated correlates model in lavaan
##################################################################
# estimate model with semtools and lavaan
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
##################################################################
# extra dependent variable model in lavaan
##################################################################
# specify lavaan model with auxiliary variables as extra outcomes
model.extradv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 ~~ severity3'
# estimate model in lavaan
fit.extradv <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.extradv, standardize = TRUE)
##################################################################
# sequential specification in lavaan
##################################################################
# specify lavaan model with factored (sequential) specification for auxiliary variables
model.factorav <- 'severity6 ~ drug + severity0 + male
severity3 ~ severity6 + drug + severity0 + male
severity1 ~ severity3 + severity6 + drug + severity0 + male'
# estimate model in lavaan
fit.factorav <- lavaan::sem(model.factorav, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.factorav, standardize = TRUE)
##################################################################
# sequential specification in mdmb
##################################################################
# estimate sample statistics in lavaan for centering
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
# summarize incomplete variables to determine ranges for pseudo-imputations
summary(dat[,c("severity6","severity0","severity3","severity1")])
# set ranges (nodes) for pseudo-imputations
nodes.severity0 <- seq(1, 7, by = .25)
nodes.severity6 <- seq(1, 7, by = .25)
nodes.severity3 <- seq(1, 7, by = .25)
nodes.severity1 <- seq(1, 7, by = .25)
# model for severity0 predictor (severity1 | drug male)
model.severity0 <- list( "model"="linreg", "formula" = severity0 ~ drug + male, nodes = nodes.severity0)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug + I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity3 auxiliary variable (severity3 | severity6 severity0 drug male)
model.severity3 <- list( "model"="linreg", "formula" = severity3 ~ severity6 + drug + severity0 + male, nodes = nodes.severity3)
# model for severity1 auxiliary variable (severity1 | severity3 severity6 severity0 drug male)
model.severity1 <- list( "model"="linreg", "formula" = severity1 ~ severity3 + severity6 + drug + severity0 + male, nodes = nodes.severity1)
# combine predictor models into a list (focal model functions as a predictor model)
predictor.models <- list(severity0 = model.severity0, severity6 = model.severity6, severity3 = model.severity3)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.severity1, ind = predictor.models)
summary(fit)
# specify lavaan model with auxiliary variables as extra outcomes
model.extradv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 ~~ severity3'
# estimate model in lavaan
fit.extradv <- lavaan::sem(model.extra.dv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.extradv, standardize = TRUE)
fit.extradv <- lavaan::sem(model.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.extradv, standardize = TRUE)
# estimate model with semtools and lavaan
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
# estimate model with semtools and lavaan
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model with no auxiliary variables
fit.noav <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.noav, standardize = TRUE)
# estimate model with semtools and lavaan
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
# estimate model with semtools and lavaan
fit.satcor <- semTools::sem.auxiliary(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml", aux = c("severity1","severity3"))
# estimate model with semtools and lavaan
library(semTools)
fit.satcor <- semTools::sem.auxiliary(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml", aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, semtools, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, semtools, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
##################################################################
# model without auxiliary variables in lavaan
##################################################################
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model with no auxiliary variables
fit.noav <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.noav, standardize = TRUE)
# estimate model with semtools and lavaan
# library(semTools)
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
model.extradv <- 'severity6 ~ drug + severity0 + male
severity1 ~ drug + severity0 + male
severity3 ~ drug + severity0 + male
severity6 ~~ severity1
severity6 ~~ severity3
severity1 ~~ severity3'
# estimate model in lavaan
fit.extradv <- lavaan::sem(model.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.extradv, standardize = TRUE)
# specify lavaan model with factored (sequential) specification for auxiliary variables
model.factorav <- 'severity6 ~ drug + severity0 + male
severity3 ~ severity6 + drug + severity0 + male
severity1 ~ severity3 + severity6 + drug + severity0 + male'
# estimate model in lavaan
fit.factorav <- lavaan::sem(model.factorav, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.factorav, standardize = TRUE)
# estimate sample statistics in lavaan for centering
lavaan::inspectSampleCov(fit.extradv, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
# summarize incomplete variables to determine ranges for pseudo-imputations
summary(dat[,c("severity6","severity0","severity3","severity1")])
# set ranges (nodes) for pseudo-imputations
nodes.severity0 <- seq(1, 7, by = .25)
nodes.severity6 <- seq(1, 7, by = .25)
nodes.severity3 <- seq(1, 7, by = .25)
nodes.severity1 <- seq(1, 7, by = .25)
# model for severity0 predictor (severity1 | drug male)
model.severity0 <- list( "model"="linreg", "formula" = severity0 ~ drug + male, nodes = nodes.severity0)
# model for severity6 outcome (severity6 | severity0 drug male)
# severity0 mean = 5.367
# male mean = .474
model.severity6 <- list("model" = "linreg", "formula" = severity6 ~ drug + I(severity0 - 5.367) + I(male - .474), nodes = nodes.severity6)
# model for severity3 auxiliary variable (severity3 | severity6 severity0 drug male)
model.severity3 <- list( "model"="linreg", "formula" = severity3 ~ severity6 + drug + severity0 + male, nodes = nodes.severity3)
# model for severity1 auxiliary variable (severity1 | severity3 severity6 severity0 drug male)
model.severity1 <- list( "model"="linreg", "formula" = severity1 ~ severity3 + severity6 + drug + severity0 + male, nodes = nodes.severity1)
# combine predictor models into a list (focal model functions as a predictor model)
predictor.models <- list(severity0 = model.severity0, severity6 = model.severity6, severity3 = model.severity3)
# estimate factored regression model w mdmb
fit <- mdmb::frm_em(dat = dat, dep = model.severity1, ind = predictor.models)
summary(fit)
# example 3.10: regression with auxiliary variables
# requires fdir, lavaan, semtools, and mdmb packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("drugtrial.dat", na.strings = "999")
names(dat) <- c("id","male","drug","severity0","severity1","severity3","severity6","dropgrp","dropout","sdrop3","sdrop6")
##################################################################
# model without auxiliary variables in lavaan
##################################################################
# specify lavaan model with no auxiliary variables
model <- 'severity6 ~ drug + severity0 + male'
# estimate model with no auxiliary variables
fit.noav <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit.noav, standardize = TRUE)
##################################################################
# saturated correlates model in lavaan
##################################################################
# estimate model with semtools and lavaan
# library(semTools)
fit.satcor <- semTools::sem.auxiliary(model, dat, aux = c("severity1","severity3"))
lavaan::summary(fit.satcor, standardize = TRUE)
# example 2.10: multiple regression
# requires fdir and lavaan packages
# set working directory
fdir::set()
# read data from working directory
dat <- read.table("smokingcomplete.dat")
names(dat) <- c("id","intensity","hvysmoker","age","parsmoke","female","race","income","pareduc")
# center variables at their grand means
dat$age.cgm <- dat$age - mean(dat$age)
dat$income.cgm <- dat$income - mean(dat$income)
# specify model
model <- 'intensity ~ parsmoke + age.cgm + income.cgm'
# regression model
fit <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = TRUE)
lavaan::summary(fit, rsquare = TRUE, standardize = TRUE)
# bootstrap standard errors and test statistics
fit <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = TRUE, se = "bootstrap")
lavaan::summary(fit, rsquare = TRUE, standardize = TRUE)
# robust standard errors and test statistics
fit <- lavaan::sem(model, dat, meanstructure = TRUE, fixed.x = TRUE, estimator = "MLR")
lavaan::summary(fit, rsquare = TRUE, standardize = TRUE)
# specify model with labels
model.labels <- 'intensity ~ b1*parsmoke + b2*age.cgm + b3*income.cgm'
wald.constraints <- 'b1 == 0; b2 == 0; b3 == 0'
# wald test that all slopes equal 0
fit <- lavaan::sem(model.labels, dat, meanstructure = TRUE, fixed.x = TRUE, estimator = "MLR")
lavaan::summary(fit, rsquare = TRUE, standardize = TRUE)
lavaan::lavTestWald(fit, constraints = wald.constraints)
# specify model with constraints
model.constraints <- 'intensity ~ b1*parsmoke + b2*age.cgm + b3*income.cgm
b1 == 0; b2 == 0; b3 == 0'
# constraining slopes to 0 gives LRT versus the saturated model
fit <- lavaan::sem(model.constraints, dat, meanstructure = TRUE, fixed.x = TRUE, estimator = "MLR")
lavaan::summary(fit, rsquare = TRUE, standardize = TRUE)
# example 8.9: maximum likelihood estimation for a multilevel regression with random intercepts;
# requires fdir and lavaan packages
# set working directory
fdir::set()
# read imputed data from working directory
dat <- read.table("problemsolving2level.dat", na.strings = "999")
names(dat) <- c("school","student","condition","teachexp","eslpct","ethnic","male","frlunch",
"achievegrp","stanmath","efficacy1","efficacy2","probsolve1","probsolve2")
# specify model
model <- '
level: 1
probsolve2 ~ probsolve1  + stanmath + frlunch
level: 2
probsolve2 ~ teachexp + condition
'
# estimate model in lavaan
fit <- lavaan::sem(model, dat,cluster = "school", meanstructure = TRUE, fixed.x = FALSE, missing = "fiml")
lavaan::summary(fit, standardize = TRUE)
# missing data patterns and proportion observed data (coverage)
inspect(fit, "patterns")
inspect(fit, "coverage")
